{% if salt['grains.get']('localhost') != salt['grains.get']('id') %}
sethostname:
  cmd.run:
    - name: hostnamectl set-hostname {{salt['grains.get']('id')}}
{% endif %}

{% set group = salt['pillar.get']('engine_reverse:'~salt['grains.get']('id')~':group') %}
{% set type = salt['pillar.get']('engine_reverse:'~salt['grains.get']('id')~':type') %}

{{(salt['grains.get']('id')|replace(salt['pillar.get']('engine:network:domaine_name'), ''))}}

{{group}}
{{type}}

{% if type == "masters" %}
{% set netpath = type~":"~(salt['grains.get']('id')|replace("."~salt['pillar.get']('engine:network:domaine_name'),''))~":network" %}
{% else %}
{% set netpath = type~":"~group~":"~(salt['grains.get']('id')|replace("."~salt['pillar.get']('engine:network:domaine_name'),''))~":network" %}
{% endif %}

{{netpath}}


